<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.goldspoon.koreabox.movie.beans.MovieAdminDAO">

	<!-- /list.ajax  
		parameter : page, pageRows
	 -->

	<select id="selectFromRow"
		resultType="com.goldspoon.koreabox.movie.beans.MovieAdminDTO">
		<![CDATA[
		SELECT
			mov_num mov_num, mov_title mov_title, mov_director mov_director, 
			mov_actors mov_actors, mov_genre mov_genre, mov_runtime mov_runtime,
			mov_openDate mov_openDate, mov_grade mov_grade
		FROM 
			(SELECT ROWNUM AS RNUM, T.* FROM 
				(SELECT * FROM tb_movie ORDER BY mov_num DESC) T) 
		WHERE 
			RNUM >= #{from} AND RNUM < (#{from} + 10)
		]]>	
	</select>
	
	<!-- SELECT 쿼리문에서 단일값 받고 싶을때
		resultType="int"
		resultType="java.lang.Integer"
	 -->
	<select id="countAll" resultType="int">
		SELECT count(*) FROM tb_movie
	</select>

	<select id="select" resultType="com.goldspoon.koreabox.movie.beans.MovieAdminDTO">
		SELECT
			mov_num mov_num, mov_title mov_title, mov_director mov_director, 
			mov_actors mov_actors, mov_genre mov_genre, mov_runtime mov_runtime,
			mov_openDate mov_openDate, mov_grade mov_grade
		FROM tb_movie ORDER 
		BY mov_num DESC
	</select>
	
	
	<select id="read" resultType="com.goldspoon.koreabox.movie.beans.MovieAdminDTO">
			SELECT mov_num mov_num, mov_title mov_title, 
			mov_director mov_director, mov_actors mov_actors, mov_genre mov_genre, 
			mov_runtime mov_runtime, mov_openDate mov_openDate, mov_grade mov_grade,
			mov_intro mov_intro, mov_poster mov_poster
			FROM tb_movie WHERE mov_num= #{mov_num}
	</select>

 	<insert id="insert" flushCache="true"
 	 		>
 		 INSERT INTO tb_movie
			(mov_num, mov_title, mov_director, mov_actors, mov_genre,
			mov_runtime, mov_openDate, mov_grade, mov_intro, 
			mov_regDate, mov_poster, mov_still1,
			mov_still2, mov_still3)
		VALUES
			(SEQ_tb_movie_mov_num.nextval, #{param1}, #{param2}, #{param3}, #{param4}, 
			#{param5}, #{param6}, #{param7}, #{param8},
			SYSDATE, #{param9}, #{param10}, 
			#{param11}, #{param12})
 	</insert>
 	
 	<update id="update" flushCache="true">
 		UPDATE tb_movie SET mov_title = #{updateDto.mov_title}, mov_director = #{updateDto.mov_director},
 			mov_actors = #{updateDto.mov_actors}, mov_genre = #{updateDto.mov_genre}, mov_runtime = #{updateDto.mov_runtime}, 
 			mov_openDate = #{updateDto.mov_openDate}, mov_grade = #{updateDto.mov_grade}, mov_intro = #{updateDto.mov_intro} 
		WHERE mov_num = #{updateDto.mov_num}
 	</update>
 	
 		<delete id="delete" flushCache="true">
		DELETE FROM tb_movie WHERE mov_num = #{param1}
	</delete>
 

 	 
 	 
</mapper>